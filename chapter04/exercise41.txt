Программа из упражнения 4.1 выполняться не будет, т.к. в определении макроса max указано, что оба значения должны иметь один и тот же тип.
В нашем же случае занчение типа std:string:size_type будет возвращено при вызове метода size(), а maxlen имеет тип int
Исправление программы заключается в смене типа переменной maxlen на std:string::size_type